<aside>
    <div class="sticky-wrapper">
        <h3>List of your schedules</h3>
        <ol>
            {% if schedule_list %}
                {% for schedule in schedule_list %}
                    <li>
                        <a href="{% url 'generatorApp:schedule' username=user.username schedule_name=schedule.name %}">
                            {{ schedule.name }}, {{ schedule.created_date }}
                        </a>

                        <br>

                        <input type="button" class="confirm-button" onclick="(
                            () => {
                                document.getElementById('confirm-div').style.visibility = 'visible';
                                document.getElementById('confirm-message').innerHTML = 'Are you sure you want to delete selected items';
                                    let confirm_form = document.getElementById('confirm-form') || null;
                                    if(confirm_form) {
                                       confirm_form.action = '{% url 'generatorApp:delete_schedule' username=user.username schedule_name=schedule.name %}' +
                                            '{% if request.GET.sort_by%}?sort_by={{request.GET.sort_by}}{% endif %}'
                                    }
                            })();
                        " value="Delete">

                        <a href="{% url 'generatorApp:settings' username=user.username schedule_name=schedule.name %}">Settings</a>

                        <ol class="schedule-data-list" style="padding-left: 2ch">
                            {% for label in labels %}
                                <li><a href="{% url 'generatorApp:schedule' username=user.username schedule_name=schedule.name%}{{label}}">{{ label }}</a></li>
                            {% endfor %}
                        </ol>
                    </li>
                {% endfor %}
            {% else %}
                <p>It seems to you don't have any schedules :<</p>
            {% endif %}
        </ol>

        <h3>Sort by:</h3>
        <form method="GET" id="sort-form">
            <select name="sort_by" id="sort_by">
                <option value="name">Name(A-Z)</option>
                <option value="created_date">Created date</option>
            </select>
        </form>
    </div>

    <script>
        $(document).ready(()=>{
            $('#sort_by').change(()=>{
                $('#sort-form').submit()
            })
        })

        const urlParams = new URLSearchParams(window.location.search)
        const sortBy = urlParams.get('sort_by')
        if(sortBy){
            $('#sort_by').val(sortBy)
        }
    </script>
</aside>
