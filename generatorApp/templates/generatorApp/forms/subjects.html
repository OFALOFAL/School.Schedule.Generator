{% extends 'generatorApp/index.html' %}
{% load static %}

{% block head %}
    <link rel="stylesheet" href="{% static 'generatorApp/schedules.css' %}">
    <title>subjects</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <style>
        .main{
            margin-left: 40%;
            margin-top: 15%;
        }
    </style>
{% endblock %}

{% block content %}

    {% include 'generatorApp/schedule_list.html' %}

    <main>
        <form method="POST" enctype="multipart/form-data" action="{{ request.get_full_path }}/upload">
            {% csrf_token %}
            <input type="file" name="file">
            <button type="submit">Upload</button>
        </form>

        <h2><b>{{ file_name }}</b></h2>
    
        <div id="confirm-div" class="center">
            <p style="height: 10%">Are you sure you want to delete selected?</p>
            <div id="confirm-buttons">
                <span>
                    <input type="button" id="cancel-button" onclick="(
                        () => {
                            document.getElementById('confirm-div').style.visibility = 'hidden';
                        })();
                    " value="Cancel">
                    <input type="submit" id="confirm-button" value="Confirm">
                </span>
            </div>
        </div>

        <div class="data-container">
            <table>
                <tr>
                    <th></th>
                    <th>ID</th>
                    <th>classes</th>
                    <th>subject name</th>
                    <th>lesson hour</th>
                    <th>teachers</th>
                    <th>classroom</th>
                    <th>subject count in week</th>
                    <th>number of groups</th>
                    <th>maximum les stack</th>
                    <th>classroom types</th>
                </tr>
                {% for value in objects_list %}
                    <tr>
                        <td><input type="checkbox" id="delete-{{ forloop.counter }}" name="delete" value="{{ value.in_id }}" form="confirm-form"></td>
                        <td>{{ forloop.counter }}</td>
                        <td>{{ value.classes_id }}</td>
                        <td>{{ value.subject_name_id }}</td>
                        <td>{{ value.lesson_hour_id }}</td>
                        <td>
                            {% for teacher in value.teachers_id %}
                                <span> {{ teacher }} </span>
                            {% endfor %}
                        </td>
                        <td>{{ value.classroom_id }}</td>
                        <td>{{ value.subject_count_in_week }}</td>
                        <td>{{ value.number_of_groups }}</td>
                        <td>{{ value.max_stack }}</td>
                        <td>
                             {% for classroom_type in value.classroom_types %}
                                <span> {{ classroom_type }} </span>
                            {% endfor %}
                        </td>
                    </tr>
                {% endfor %}

            </table>
        </div>
    
        <input type="button" class="confirm-button" onclick="(
            () => {
                document.getElementById('confirm-div').style.visibility = 'visible';
                document.getElementById('confirm-message').innerHTML = 'Are you sure you want to delete selected items';
                    let confirm_form = document.getElementById('confirm-form') || null;
                    if(confirm_form) {
                       confirm_form.action = '{{ request.get_full_path }}/delete'
                    }
            })();
        " value="Delete">


        <form method="POST">
            {% csrf_token %}
            <div>Add subjects</div>

            <select class="t" id="class-id" name="class-id">
                {% for object in classes_queryset %}
                    <option value="{{ object.in_id }}">{{ object }}</option>
                {% endfor %}
            </select>

            <select class="t" id="subject-name" name="subject-name">
                {% for object in subject_names_queryset %}
                    <option value="{{ object.in_id }}">{{ object }}</option>
                {% endfor %}
            </select>

            <select class="t" id="teachers" name="teachers" multiple="multiple">
                {% for object in teachers_queryset %}
                    <option value="{{ object.in_id }}">{{ object }}</option>
                {% endfor %}
            </select>

            {{ form.subject_count_in_week }}
            {{ form.number_of_groups }}
            {{ form.max_stack }}

            <select class="t" id="classroom-type-id" name="classroom-type-id" multiple="multiple">
                {% for object in classroom_types_queryset %}
                    <option value="{{ object.in_id }}">{{ object }}</option>
                {% endfor %}
            </select>

            <input type="submit" value="Add">
        </form>

    </main>

{% endblock %}
